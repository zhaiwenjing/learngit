


[基于微信平台的华师订餐系统]

详细设计说明书




    学院            华中师范大学计算机学院           

    专业              2013级软件工程四班             

    拟制人     刘会云、张筱晗、翟文静、张黎闻、何静   







2015年10月8日


1引言	3
1.1编写目的	3
1.2背景	3
1.3定义	3
1.4参考资料	3

2程序系统的结构	4

3程序1（标识符）设计说明	5
3.1程序描述	5
3.2功能	5
3.3性能	6
3.4输人项	7
3.5输出项	8
3.6算法	9
3.7流程逻辑	11
3.8接口	12
3.9存储分配	13
3.10注释设计	14
3.11限制条件	14
3.12测试计划	14
3.13尚未解决的问题	14

 
详细设计说明书
1引言
1.1编写目的
为明确基于微信平台的学生订餐系统的结构、安排项目规划与进度、制定详细测试计划、组织软件开发与测试，特撰写本文档。
    从该阶段开发正式进入软件的实际开发阶段，本阶段完成系统的细设计，并且明确系统的详细设计模块与用例需求。详细设计说明书的目的就是非常细化软件设计阶段得出的软件所有模型，把它加工成在程序细节上非常接近于源程序软件表示。
1.2背景
说明：
A、软件的名称是：《基于微信平台的华师订餐系统》
B、本项目的任务提出者：何静
   本项目的任务开发者：刘会云、张筱晗、翟文静、张黎闻
   本项目针对用户：华师在校师生
1.3定义
用户	基于微信订餐平台中合法的系统用户
管理员	系统的管理者
购物车	存放用户在确定订餐前所点选的菜品
店家	基于微信订餐平台中合法的展示餐品的店家

1.4参考资料
[1]《ASP.NET实用案例教》.石志国.北京:清华大学出版社2003.7. 
[2]《ASP.NET动态网站开发教程》李英俊，毕斐.北京:清华大学出版
[3]《软件工程》（第二版）.叶俊民.
[4]《数据结构与算法基础》.大连理工大学出版社
2程序系统的结构
本程序使用B/S架构并使用了四层逻辑结构结果，如下面的图1所示：

用户层（UI）	业务逻辑层（BLL）	数据访问层（DAL）	数据层（DB）
图1   系统结构示意图

以下为用户整体订餐流程图，也是我们的核心工作流程图，如图2所示：






















图2  用户订餐流程图
我们的核心工作流程为订餐，为了给用户一个更好的订餐享受，我们添加了很多增加用户体验的工作，提高了订餐效率，并且给用户一个更好的享受。

3程序1（标识符）设计说明
从本章开始，逐个地给出各个层次中的每个程序的设计考虑。以下给出的提纲是针对一般情况的。对于一个具体的模块，尤其是层次比较低的模块或子程序，其很多条目的内容往往与它所隶属的上一层 模块的对应条目的内容相同，在这种情况下，只要简单地说明这一点即可。
3.1程序描述
本项目通过建立一个基于微信平台的订餐系统，为订餐的用户和管理者提供不同的服务，其中，订餐的用户能够通过此平台来进行菜色浏览，订餐和提交订单。

3.2功能
该程序主要是实现在微信平台上通过关注微信公共号实现预约定餐、点菜和结账功能，同时应该完成以下功能：在未就餐之前还可以退餐，对于这其中的问题，我们都给出很仔细的处理，也许这些都是比较小的细节，但是这些我们都做得很细，以方便餐馆进行管理，减小餐馆与客户间发生冲突的概率。IPO图（即输入一处理一输出图）如图所示：
 




3.3性能
3.3.1 精度需求 
在精度需求上，根据使用需要，在各项数据的输入，输出及传输过程中，可以满足各种精度的需求。
 3.3.2 时间需求 
在软件方面，响应时间，更新处理时间都比较快且迅速，完全满足用户要求。 对于该系统，当用户进行某一项操作，其响应时间应该在一定可以接受的范围内，太慢的话就会显得很不适用。当新增一个预约或其它操作时应该能够在主GUI上面能及时的显示出来，而不能有太多的延时，因此我们采用了观察者模式以能及时更信息，当随着日期的改变时所有的信息也应该跟着的变化。由于要读写数据库，因此对手机的配置也有一定的要求，太差的话可能导致反应很慢， 为保证功能很好实现一定要保证及时性和准确性。
3.3.3 灵活性 
当用户需求，如操作方式，运行环境，结果精度，数据结构于其他软件接口 等发生变化时，设计的软件要做适当调整,灵活性非常大。   
3.3.4故障处理 
a. 内部故障处理：在开发阶段可以随即修改数据库里的相应内容。   
b. 外部故障处理：对编辑的程序进行重装载时，第一次装载认为错，修改。 第二次运行，在需 求调用时出错，有错误提示，重试。   
3.3.5系统安全性 
对于ACCESS数据我们进行了加密，当然BOSS有权知道这个密码，对于使用该用户的操作员也要知道一个用户名和密码才能登录使用，也许这样还是不能满足需要，如果操作员稍为离开一会儿，难道为了不让人不经意或有意修改数据内容，就要关闭整个程序吗？不用这里我们提供了一种锁机制，当用户要稍为离开时可以选择锁定系统，此时任何人要想再使用户就必须知道当前登录用户名的密码才能恢复系统。
3.3.6可操作性和易维护性 
本程序采用JAVA SWING GUI 编写，易看易懂的界面，操作也相当简单，只要是能熟练使用电脑的人都能熟练的上手。
3.4输人项
新增预约：姓名、地址、电话号码
名称	标识	数据类型	数据格式	数据值的有效范围	输入媒体	数据来源
姓名	Cname	varchar		2~5个字符	手机微信	顾客
地址	Caddr	varchar			手机微信	顾客
电话号码	Cphone	varchar	18100000000	11位数字	手机微信	顾客


点菜：根据菜单选菜
采用列表打钩形式

添加菜名和酒水：商品名、价格
名称	标识	数据类型	数据格式	数据值有效范围	输入媒体	数据来源
商品名	Dname	varchar		1~15个字符	店家微信公共平台	店家
价格	Dprice	varchar	12.5	可包含一位小数	店家微信公共平台	店家


删除菜名和酒水：商品名
名称	标识	数据类型	数据格式	数据值有效范围	输入媒体	数据来源
商品名	Dname	varchar		1~15个字符	店家微信公共平台	店家


3.5输出项
完成订单：客户姓名、联系电话、客户地址、订单号
名称	标识	数据类型	数据格式	数据值的有效范围	输出媒体
姓名	Cname	varchar		2~5个字符	顾客&店家微信
地址	Caddr	varchar			顾客&店家微信
电话号码	Cphone	varchar	18100000000	11位数字	顾客&店家微信
订单号	Cno	varchar	88888888	00000000~99999999	顾客&店家微信



取消订单：要取消的订单号、原订单号
名称	标识	数据类型	数据格式	数据值的有效范围	输出媒体
要取消的订单号	Nno	varchar	99999999	00000000~99999999	顾客&店家微信
原订单号	Cno	varchar	88888888	00000000~99999999	顾客&店家微信







结账：姓名、电话、日期、应付款、订单号
名称	标识	数据类型	数据格式	数据值的有效范围	输出媒体
姓名	Cname	varchar		2~5个字符	顾客&店家微信
电话号码	Cphone	varchar	18100000000	11位数字	顾客&店家微信
日期	Ctime	varchar	20150101	20000101~29991231	顾客&店家微信
订单号	Cno	varchar	88888888	00000000~99999999	顾客&店家微信


3.6算法
int i;
一页显示的记录数 = 10; 
取得待显示页码
 PageSet :  strPage = page; 
if(strPage==null)//page参数为空时，此时显示第一页数据
 { 
待显示页码 = 1;
 }
 else{  
待显示页码 = Integer.parseInt(strPage); //将字符串转换成整型 
if(待显示页码<1) 待显示页码 = 1; 
} 
执行SQL语句并获取结果集 
ResultSet rs = sqlStmt.executeQuery("SQL”);
 获取记录总数
 rs.last(); 
记录总数 = rs.getRow(); 
记算总页数 
总页数 = (记录总数+设置一页显示的记录数-1) / 一页显示的记录数; 
调整待显示的页码 
if(待显示页码>总页数) 待显示页码 = 总页数;
 // 分页情况分类   
//选择向上翻 
if(待显示页码>1) 
{ 
选择向上翻一页传递参数pageda=待显示页码-1 goto PageSet; 
} 
//选择向下翻 
if(待显示页码<总页数) 
{ 
选择向下翻一页传递参数pageda=待显示页码+1 goto PageSet;
 } 
If(选择到尾页)
 { 
选择到尾页传递参数pageda=总页数 goto PageSet;
} 
页次=待显示页码 / 总页数页    
if(总页数>0)
{ 
将记录指针定位到结果集的第一条记录上((待显示页码-1) * 一页显示的记录数 + 1);
 i = 0; 
while(i<一页显示的记录数 && 数据库指针不在结果集尾部)
{
 输出要分页显示的数据库中的内容； 
将数据库指针移动到当前行的下一行;
 i++;
 }
 } 





3.7流程逻辑






























3.8接口
3.8.1用户接口   
用户通过网络以b/s的方式访问系统，用户访问微信平台，系统各类角色访问后台管理网站。用户成功登录该系统后，按浏览器方式使用该系统与角色权限相关的功能。
微信平台订餐系统GUI及内部处理模块均采用JAVA实现，用户订餐情况通过微信平台手动选择输入，系统提供菜单及菜单的编辑功能，结账模块提供顾客消费额和折扣。由于本系统采用JAVA实现，所以只要预装JVM的终端都能运行此系统，移植性极高。由于出于学习目的，数据库采用MS-SQL SERVER 2000，故Linux及Unix系统用户需要另外配置数据库。   

3.8.2内部接口  
数据库模块的操作由管理员通过密码登陆，然后对数据库进行相应的操作。通过对数据库要进行的不同的操作来决定调用另外的哪个模块。内部接口方面，模块间采用函数调用、参数传递、返回值的方式进行信息传递。具体参数的结构将在下面内容中说明。接口传递的信息将是以数据结构封装了的数据，以参数传递或返回值的形式在各模块间传输。  
各个模块之间接口：本系统整体采用的模式为观察者模式，被观察者为BookingSystem类，观察者为MainTable类，当BookingSystem类有所变化时，MainTable类就会自动及时更新，并将更新后的信息显示给用户。 本系统数据交互层通过DBConnection类与数据库进行数据交互，主要包括数据插入、删除、更新等操作。DBConnection类提供了一个接口给上层的Restaurant类及BookingSystem类，MainTable类对BookingSystem类有一个引用，每个功能模块，包括登陆、解锁、结账、点菜、添加删除订单、都有一个对BookingSystem类的引用，即BookingsSystem类提供了一个公共接口，并且可以说是整个系统的核心。 

3.8.3外部接口   
软件接口：
系统提供了供其它软件使用的函数，以达到软件的复用性。利用Visual C#提供与SQL Server2000连接进行访问数据库的操作。服务器程序可利用SQL Server2000提供的对数据库备份的操作实现对数据库的备份操作。在网络软件接口方面，采取一种无差错的传输协议进行连接。 

硬件接口：
本系统通过JVM与底层硬件层交流。
输入：采用手机触屏输入以及Visual C#的标准输入/输出进行输入处理。 
输出：采用Visual C#的标准输入/输出或其它输出设备对输出进行处理。在统计打印模块还需要有打印机的参与。 
    在网络传输部分，在网络硬件部分，为了实现高速传输，将使用高速ATM。 
本系统所涉及的硬件有：微机服务器和手机。 
所涉及的系统软件有： 操作系统：Windows XP/2007/2008及以上，数据库：MS-SQL SERVER 2000，服务器：IIS 6.0 ，浏览器：IE 10.0 
与手机客户端的接口
	IE10.0  
	Windows 2000 proffical
	手机客户端

3.9存储分配
名称	长度	数据类型
地址	30	Char
联系方式	20	Char
店家名称	10	Char
菜单名称	20	Char
菜单金额	15	Float
剩余数量	10	Long
订餐数量	10	Long
支付金额	15	Float
订单时间	10	Char


3.10注释设计
说明准备在本程序中安排的注释：
1. 在模块首部注释说明本模块开始编写的时间，编写人员，及其基本功能
2. 加在各分枝点的注释说明订餐完成所要具备的条件
3. 对菜单变量和费用变量进行说明，指出用户可以选择的菜单种类和所消费的金额。
4. 注释说明不同折扣情况对用户金额费用的收取规则不同，指出具体的计算方法。
3.11限制条件
必须保障有网络，服务器正常连接。

3.12测试计划
本模块针对用户订餐信息在测试时要求对测试输入数据到数据库，同时能够在外部查询得到准确的读出数据。
进行用户订单、退单测试，验证数据的准确性。进行更新店家菜单信息和金额计算查询同样确保查找的准确性。
   测试用例：选取有代表性的数据，避免使用穷举法。
   测试方法：使用白盒测试法，语句覆盖、判定覆盖、条件覆盖等操作。

3.13尚未解决的问题
对数据库的链接。

